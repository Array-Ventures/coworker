services:
  coworker:
    image: ghcr.io/array-ventures/coworker:latest
    pull_policy: always
    ports:
      - '127.0.0.1:4111:4111'
    environment:
      - DATABASE_URL=file:/data/mastra.db
      - INNGEST_BASE_URL=http://inngest:8288
      - INNGEST_DEV=1
      - WORKSPACE_PATH=/workspaces
      - WHATSAPP_AUTH_DIR=/data/whatsapp-auth
      - GOG_HOME=/data/gog
      - GOG_KEYRING_PASSWORD=${GOG_KEYRING_PASSWORD:-}
      - MODEL=${MODEL:-}
      - AGENT_ID=${AGENT_ID:-}
      - OPENAI_API_KEY=${OPENAI_API_KEY:-}
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY:-}
      - GOOGLE_GENERATIVE_AI_API_KEY=${GOOGLE_GENERATIVE_AI_API_KEY:-}
      - GROQ_API_KEY=${GROQ_API_KEY:-}
      - NVIDIA_API_KEY=${NVIDIA_API_KEY:-}
      - KIMI_API_KEY=${KIMI_API_KEY:-}
    volumes:
      - data:/data
      - workspaces:/workspaces
    depends_on:
      - inngest

  inngest:
    image: inngest/inngest:v1.12.1
    command: inngest dev -p 8288 -u http://coworker:4111/api/inngest --poll-interval=1
    ports:
      - '127.0.0.1:8288:8288'

volumes:
  data:
  workspaces:
